{% extends "./layout_full-width.html" %}

{% block page_title %}
	Service Green
{% endblock %}

{% block content %}

<div class="VOC-exit-routes_container" id="VOC-exit-routes_container">
     <div class="main">
          <div class="VOC-exit-routes_banner">
               <div id="recruit-message">
                    <h2 class="heading-small">Tell us what you think of service green</h2>
                    <a class="VOC-exit-routes_banner__close-btn font-xsmall" href="#1" onclick="hideOrReset()">Close</a>
                    <a href="#1" onclick="showSurvey()">Take a short survey to give us your feedback</a> 
               </div>
               <div id="survey-header" class="js-hidden">
                    <h2 class="heading-small">Tell us what you think of service green</h2>
                    <a class="VOC-exit-routes_banner__close-btn font-xsmall" href="#1" onclick="hideOrReset()">Close</a>
               </div>
               <div id="survey-done" class="js-hidden">
                    <h3 class="heading-small" style="margin:0px;">Thank you for your feedback</h3>
               </div>              
          </div>

          <div class="VOC-exit-routes_survey grid-row js-hidden" id="exit-routesSurvey">
               <div class="VOC-exit-routes_survey__page" id="VOC-exit_page0">
                    <div class="column-two-thirds">
                         <p class="font-xsmall">We'll send you a link to a feedback form. It only takes 2 minutes to fill in. Don't worry we won't send you spam or share your email address with anyone.</p>
                         <form>
                              <div class="form-group form-group-compound">
                                <label class="form-label" for="email">Email address</label>
                                <input class="form-control form-control-3-4" id="email" name="email" type="text">
                              </div>
                              <div class="inline">
                                   <a href="#1" class="button">Send contact details</a>
                                   <a href="#1" class="button beta-link-button">Don't have an email address?</a>
                              </div>
                         </form>
                    </div>
               </div>
          </div>
     </div>
</div>

{% include "./includes/phase_banner_beta_full-width.html" %}

<header class="PROD_hero">
     <div class="PROD_full-page-width-wrapper">
          <div class="grid-row">
               <div class="column-two-thirds">
                    <h1 class="heading-xlarge">Service Green</h1>
                    <p class="lede">Explore what kind of work is right for you, and take the next steps towards what you want to be</p>
                    <form id="searchForm">
                         <!-- <label>Enter a job title</label> -->
                         <div class="PROD_search">
                              <div id="search-box" class="PROD_search__input-container">
                                   <input id="searchInput" class="PROD_search__input" autocomplete="off" placeholder="Enter a job title or keywords" type="text">
                              </div>
                              <input class="PROD_search__submit" onclick="saveSearchTermsAndContinue()" type="button" value="Search">
                         </div>
                    </form>
               </div>
          </div>
     </div>
</header> 
<main id="content" role="main">
     <div class="grid-row">
          <div class="column-full">
               <h2 class="heading-medium">Explore by job category</h2>
          </div>
          <div class="column-one-third">
               <ul class="list category-list">
                    <li><a href="#1" class="prototype-link">Administration</a></li>
                    <li><a href="#1" class="prototype-link">Animal care</a></li>
                    <li><a href="#1" class="prototype-link">Beauty and wellbeing</a></li>
                    <li><a href="#1" class="prototype-link">Business and finance</a></li>
                    <li><a href="#1" class="prototype-link">Delivery and storage</a></li>
                    <li><a href="#1" class="prototype-link">Computing, technology and digital</a></li>
                    <li><a href="#1" class="prototype-link">Construction and trades</a></li>
                    <li><a href="#1" class="prototype-link">Creative and media</a></li>
               </ul>
          </div>
          <div class="column-one-third">
               <ul class="list category-list">
                    <li><a href="#1" class="prototype-link">Emergency and uniform services</a></li>
                    <li><a href="#1" class="prototype-link">Engineering and maintenance</a></li>
                    <li><a href="#1" class="prototype-link">Environment and land</a></li>
                    <li><a href="#1" class="prototype-link">Government services</a></li>
                    <li><a href="#1" class="prototype-link">Healthcare</a></li>
                    <li><a href="#1" class="prototype-link">Hospitality and food</a></li>
                    <li><a href="#1" class="prototype-link">Legal</a></li>
                    <li><a href="#1" class="prototype-link">Managerial</a></li>
               </ul>
          </div>
          <div class="column-one-third">
               <ul class="list category-list">
                    <li><a href="#1" class="prototype-link">Manufacturing</a></li>
                    <li><a href="#1" class="prototype-link">Retail and sales</a></li>
                    <li><a href="#1" class="prototype-link">Science and research</a></li>
                    <li><a href="#1" class="prototype-link">Social care</a></li>
                    <li><a href="#1" class="prototype-link">Sports and leisure</a></li>
                    <li><a href="#1" class="prototype-link">Teaching and education </a></li>
                    <li><a href="#1" class="prototype-link">Transport</a></li>
                    <li><a href="#1" class="prototype-link">Travel and tourism</a></li>
               </ul>
          </div>
     </div>
</main>

<script>
// This function gets the value entered in the search box and saves it to the session data
// Then loads the next page
function saveSearchTermsAndContinue() {
     var searchPrompt = "Enter a job title or keywords";
     window.setSessionData('searchPrompt', searchPrompt);
     var searchTerm = document.getElementById('searchInput').value;
     window.setSessionData('searchTerm', searchTerm, function(){
          setTimeout(changePage, 500);
          function changePage() {
               window.location.href="search-results_blank_v2";
          }
     });
}

// This function make sure the form is submitted when search field is in focus and the user presses enter
// This function is overriding one set in the accessible-typeahead.min.js that doesn't allow this behaviour if there are auto-complete options
function searchOnReturn() {
     var searchContainer = document.getElementById("searchInput");
     var e = window.event;
     searchContainer.addEventListener('keydown', function(e) {
          if (e.which === 13 || e.keycode === 13) {
               e.preventDefault();
               saveSearchTermsAndContinue();
          }
     });
} 

function init () {
     searchOnReturn();
}
window.onload = init;

/* --------------------------------------------------------
     VOC exit routes banner
-------------------------------------------------------- */

// Variables

var survey = document.getElementById('exit-routesSurvey');

// Functions

function showSurvey() {
     survey.classList.remove('js-hidden');
     document.getElementById('recruit-message').classList.add('js-hidden');
     document.getElementById('survey-header').classList.remove('js-hidden');
}

function hideSurvey() {
     survey.classList.add('js-hidden');
}

function endSurvey() {
     hideSurvey();
     document.getElementById('survey-done').classList.remove('js-hidden');
     document.getElementById('survey-header').classList.add('js-hidden');
}

function submitFeedback() {
     surveySubmitted = true;
     surveyNextQuestion();
}

function resetSurvey() {
     hideSurvey();
     surveyInit();
     document.getElementById('recruit-message').classList.remove('js-hidden');
     document.getElementById('survey-header').classList.add('js-hidden');
     surveySubmitted = false;
}

function hideOrReset() {
     document.getElementById('VOC-exit-routes_container').classList.add('js-hidden');
     // surveySubmitted ? endSurvey() : resetSurvey();
}


function initPageModel() {
     currentPage = 0;
     nextPage = 1;
     prevPage = -1;
}

function initPageBranchModel(){
     branchModel = {};
}

function updatePageBranchModel(pageNumber, branchLetter){
     branchModel[pageNumber] = branchLetter;
}

function checkForPageBranch(direction){
     var pageBranch = '';
     for (var key in branchModel) {
          if (direction === 'next' && key === nextPage.toString()) {
               pageBranch = branchModel[key];
          }
          if (direction === 'prev' && key === prevPage.toString()) {
               pageBranch = branchModel[key];
          }
          if (direction === 'current' && key === currentPage.toString()) {
               pageBranch = branchModel[key];
          }
     }
     return pageBranch;
}

function surveyInit() {
     surveySubmitted = false;

     var surveyPages = document.getElementsByClassName('VOC-exit-routes_survey__page');

     for(i = 0; i < surveyPages.length; i++) {
          if(i > 0) {
               surveyPages[i].classList.add('js-hidden');
          } else {
               surveyPages[i].classList.remove('js-hidden');
          }
     }
     initPageModel();
     initPageBranchModel();
}
surveyInit();

function surveyNextQuestion() {
     var branch = checkForPageBranch('next');
     var branchCurrent = checkForPageBranch('current');

     var thisPageId = 'VOC-exit-routes_page' + currentPage.toString() + branchCurrent;
     var thisPageElement = document.getElementById(thisPageId);
     thisPageElement.classList.add('js-hidden');

     var nextPageId = 'VOC-exit-routes_page' + nextPage.toString() + branch;
     var nextPageElement = document.getElementById(nextPageId);
     nextPageElement.classList.remove('js-hidden');

     updatePageModel('next');
}

function surveyPrevQuestion() {
     var branch = checkForPageBranch('prev');
     var branchCurrent = checkForPageBranch('current');

     var thisPageId = 'VOC-exit-routes_page' + currentPage.toString() + branchCurrent;
     var thisPageElement = document.getElementById(thisPageId);
     thisPageElement.classList.add('js-hidden');

     var prevPageId = 'VOC-exit-routes_page' + prevPage.toString() + branch;
     var prevPageElement = document.getElementById(prevPageId);
     prevPageElement.classList.remove('js-hidden');

     updatePageModel();
}

function updatePageModel(thisDirection) {
     if (thisDirection === 'next') {
          currentPage = currentPage+1;
          nextPage = nextPage+1;
          prevPage = prevPage+1;
     } else {
          currentPage = currentPage-1;
          nextPage = nextPage-1;
          prevPage = prevPage-1
     }
}

// function didYouFind() {
//      if(document.getElementById('find-no').checked) {
//           updatePageBranchModel(nextPage.toString(), 'b');
//           surveyNextQuestion();
//      } else {
//           updatePageBranchModel(nextPage.toString(), '');
//           surveyNextQuestion();
//      }
// }

</script>


{% endblock %}
